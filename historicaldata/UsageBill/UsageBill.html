<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Usage and Billing</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin-left: 20px;
            background-color: #0B1437;
            color: #e7dede;
        }

        h1, h2 {
            color: #cdd1d8;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: rgba(17, 28, 68, 0.4);
            margin-top: 20px;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        th, td {
            border: 1px solid #042750;
            padding: 10px 12px;
            text-align: center;
            color: #cdd1d8;
        }

        th {
            background-color: #111C44;
            color: #e8dcdc;
            font-weight: normal;
        }

        .container {
            display: flex;
            flex-direction: column;
            /* gap: 20px; */
        }

        .card {
            background-color: #111C44;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .results-header {
            margin-top: 10px;
            font-weight: 500;
            color: #eee7e7;
        }

        button {
            background: linear-gradient(to right, #20379d, #0d0a68);
            color: #fff;
            margin-top: 10px;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        button:hover {
            transform: scale(1.05);
        }
        button#viewBtn {
            border: 1px solid #cdd1d8;
        }

        label {
            /* display: block; */
            margin-bottom: 10px;
        }
        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: #f7f9fc;
            border: 1px solid #ced4da;
            padding: 8px 30px 8px 10px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><path fill="%232C3E50" d="M7,10l5-5H2L7,10z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 16px;
            transition: border-color 0.2s ease;
        }

        #reportType {
            margin-left: 10px;
            margin-right: 10px;
            margin-bottom: 5px;
        }
        #meterId {
            margin-left: 10px;
            margin-right: 10px;
            margin-bottom: 5px;
        }
        #monthInput {
            margin-left: 10px;
            margin-right: 10px;
            margin-bottom: 5px;
        }
        #yearInput {
            margin-left: 10px;
            margin-right: 10px;
            margin-bottom: 5px;
        }
        #startDate, #endDate {
            margin-left: 10px;
            margin-right: 10px;
            margin-bottom: 5px;
        }

select:hover {
    border-color: #aab7c4;
}

select:focus {
    border-color: #667eea;
    outline: none;
}

#yearInput
{
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #f7f9fc;
    border: 1px solid #ced4da;
    padding:8px ;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
}
#monthInput
{
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #f7f9fc;
    border: 1px solid #ced4da;
    padding: 8px 20px 8px 10px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
}
#startDate, #endDate
{
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: #f7f9fc;
    border: 1px solid #ced4da;
    padding: 8px 20px 8px 10px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
}
    </style>
</head>

<body>
    <h2>Energy Usage and Billing</h2>

    <div class="container">
        <!-- Report and Meter ID Selection -->
        <div class="card">
            <label>
                Report Type:
                <select id="reportType">
                    <option value="monthly">Monthly Report</option>
                    <option value="yearly">Yearly Report</option>
                </select>

                Meter ID:
                <select id="meterId">
                    <option value="12345">12345</option>
                    <option value="67890">67890</option>
                </select>

                Month:
                <input type="month" id="monthInput" min="2010-01" max="2023-09">
                
            </select>
                Year:
                <input type="number" id="yearInput" placeholder="yyyy" min="2010" max="2023">


            </select>
                <label>Custom Time Range:</label>
                Start: <input type="date" id="startDate">
                End: <input type="date" id="endDate">
            </select>
            <button id="viewBtn">View</button>
        </div>

        <!-- Results Header -->
        <div class="results-header card">
            Meter ID: <span id="selectedMeterId"></span>
            Date Range: <span id="selectedDateRange"></span>
        </div>

        <!-- Results Table -->
        <!-- <h2>Results</h2> -->
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Total Energy Usage</th>
                    <th>Electricity Bill (RM)</th>
                </tr>
            </thead>
            <tbody>
                <!-- To be populated dynamically -->
            </tbody>
            <tfoot>
                <!-- Totals will be populated here -->
            </tfoot>
        </table>
    </div>

    <script>
    const reportTypeSelect = document.getElementById("reportType");
    const monthInput = document.getElementById("monthInput");
    const yearInput = document.getElementById("yearInput");
    const startDateInput = document.getElementById("startDate");
    const endDateInput = document.getElementById("endDate");
    const viewBtn = document.getElementById("viewBtn");
    const resultsTableBody = document.querySelector("table tbody");
    
    

    viewBtn.addEventListener("click", populateData);

    function populateData() {
        let content = "";
        let totalEnergy = 0; // Initialize total energy counter
        let totalBill = 0; // Initialize total bill counter
        const currentDate = new Date();
        const customStartDate = startDateInput.value;
        const customEndDate = endDateInput.value;

        if (customStartDate && customEndDate) {
            const daysInCustomRange = (new Date(customEndDate) - new Date(customStartDate)) / (1000 * 60 * 60 * 24);
            content = Array.from({ length: daysInCustomRange }, (_, i) => {
                const date = new Date(new Date(customStartDate).getTime() + i * 24 * 60 * 60 * 1000);
                totalEnergy += 50;
                totalBill += 100;
                return `<tr>
                    <td>${date.toISOString().split('T')[0]}</td>
                    <td>50 kWh</td>
                    <td>RM 100</td>
                </tr>`;
            }).join("");
            document.getElementById("selectedDateRange").innerText = `${customStartDate} to ${customEndDate}`;
        } 
        else if (reportTypeSelect.value === "monthly") {
            const selectedMonth = monthInput.value.split("-")[1];
            const selectedYear = monthInput.value.split("-")[0];
            const daysInMonth = (currentDate.getFullYear() === parseInt(selectedYear) && currentDate.getMonth() + 1 === parseInt(selectedMonth))
                ? currentDate.getDate() 
                : new Date(selectedYear, selectedMonth, 0).getDate();

            content = Array.from({ length: daysInMonth }, (_, i) => {
                totalEnergy += 50;
                totalBill += 100;
                return `<tr>
                    <td>${selectedYear}-${selectedMonth}-${String(i + 1).padStart(2, '0')}</td>
                    <td>50 kWh</td>
                    <td>RM 100</td>
                </tr>`;
            }).join("");
            document.getElementById("selectedDateRange").innerText = monthInput.value;
        } 
        else {
            const selectedYear = yearInput.value;
            const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            
            content = months.map(month => {
                totalEnergy += 1500;
                totalBill += 3000;
                return `<tr>
                    <td>${month} ${selectedYear}</td>
                    <td>1500 kWh</td>
                    <td>RM 3000</td>
                </tr>`;
            }).join("");
            document.getElementById("selectedDateRange").innerText = yearInput.value;
        }

        // Append the total row at the end
        content += `<tr style="font-weight:bold;">
                        <td>Total</td>
                        <td>${totalEnergy} kWh</td>
                        <td>RM ${totalBill}</td>
                    </tr>`;
        
        document.getElementById("selectedMeterId").innerText = document.getElementById("meterId").value;
        resultsTableBody.innerHTML = content;
    }

    // Populate year selector with years from the current year going back 10 years
    const currentYear = new Date().getFullYear();
    const yearOptions = Array.from({ length: 11 }, (_, i) => currentYear - i).map(year => `<option value="${year}">${year}</option>`).join("");
    yearInput.innerHTML = yearOptions;

    // Automatically show data for the current month on page load
    monthInput.value = new Date().toISOString().slice(0, 7);
    populateData();

    </script>
</body>
</html>
